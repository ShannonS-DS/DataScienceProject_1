histogram(~ AvgIntFICO | factor(State), data = loansMod)
histogram(~ AvgIntFICO | factor(Home.Ownership), data = loansMod)
histogram(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod)
histogram(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
histogram(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
histogram(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, plot.points = FALSE, auto.key = TRUE)
densityplot(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
densityplot(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, groups = HomeOwner)
densityplot(~ AvgIntFICO, data = loansMod, groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
qqmath(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, groups = HomeOwner, f.value = ppoints(100), auto.key = TRUE, type = c("p", "g"), aspect = "xy")
qq(HomeOwner ~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, f.value = ppoints(100), type = c("p", "g"), aspect = 1)
renewableHO <- subset(x=loansMod, subset=LoanPurposeRank > 0,select = row:LoanLength)
qq(HomeOwner ~ AvgIntFICO | factor(Loan.Purpose), data = renewableHO, f.value = ppoints(100), type = c("p", "g"), aspect = 1)
remove(renewableHO)
qq(HomeOwner ~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, f.value = ppoints(100), type = c("p", "g"), aspect = 1)
qq(HomeOwner ~ Interest.Rate | factor(Loan.Purpose), data = loansMod, f.value = ppoints(100), type = c("p", "g"), aspect = 1)
qq(HomeOwner ~ IntRatePrim | factor(Loan.Purpose), data = loansMod, f.value = ppoints(100), type = c("p", "g"), aspect = 1)
bwplot(factor(Loan.Purpose) ~ IntRatePrim | (HomeOwner, data = loansMod)
bwplot(factor(Loan.Purpose) ~ IntRatePrim | HomeOwner, data = loansMod)
bwplot(factor(Loan.Purpose) ~ IntRatePrim | HomeOwner, data = loansMod, box.ratio=)
bwplot(factor(Loan.Purpose) ~ IntRatePrim | HomeOwner, data = loansMod, box.ratio=1)
bwplot(factor(Loan.Purpose) ~ IntRatePrim | HomeOwner, data = loansMod, box.ratio=2)
bwplot(factor(Loan.Purpose) ~ IntRatePrim | HomeOwner, data = loansMod, box.ratio=3)
bwplot(IntRatePrim ~ HomeOwner| factor(Loan.Purpose) , data = loansMod, layout = c(6, 1))
bwplot(IntRatePrim ~ HomeOwner| factor(Loan.Purpose) , data = loansMod, layout = c(10, 1))
bwplot(IntRatePrim ~ HomeOwner| factor(Loan.Purpose) , data = loansMod, layout = c(20, 1))
bwplot(factor(Loan.Purpose) ~ IntRatePrim | HomeOwner, data = loansMod)
library("MASS", lib.loc="C:/Program Files/R/R-2.15.2/library")
xyplot(Open.CREDIT.Lines ~ IntRatePrim, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "Open.CREDIT.Lines", ylab = "IntRatePrim")
xyplot(DebtToIncPrim ~ IntRatePrim, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "DebtToIncPrim", ylab = "IntRatePrim")
xyplot(AvgIntFICO ~ IntRatePrim, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "AvgIntFICO", ylab = "IntRatePrim")
xyplot(AvgIntFICO ~ Revolving.CREDIT.Balance, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "AvgIntFICO", ylab = "Revolving.CREDIT.Balance")
xyplot(IntRatePrim ~ Revolving.CREDIT.Balance, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "IntRatePrim", ylab = "Revolving.CREDIT.Balance")
xyplot(Revolving.CREDIT.Balance ~ IntRatePrim, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), ylab = "IntRatePrim", xlab = "Revolving.CREDIT.Balance")
xyplot(IntRatePrim ~ Employment.Length, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "IntRatePrim", ylab = "Employment.Length")
xyplot(IntRatePrim ~ EmpYrs, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "IntRatePrim", ylab = "EmpYrs")
xyplot(IntRatePrim ~ LoanPurposeRank, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "IntRatePrim", ylab = "LoanPurposeRank")
xyplot(LoanPurposeRank ~ IntRatePrim, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), ylab = "IntRatePrim", xlab = "LoanPurposeRank")
dist(loansMod)
distxy <- dist(loansMod)
hClustering <- hclust(distxy)
plot(hClustering)
myplclust(hClustering,lab=rep(1:3,each=4),lab.col=rep(1:3,each=4))
install.packages("PerformanceAnalytics")
library("PerformanceAnalytics", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
dataMatrix <- as.matrix(loansMod)[sample(1:100),]
heatmap(dataMatrix)
dataMatrix <- as.matrix(loansMod)[sample(1:100),22:23]
heatmap(dataMatrix)
dataMatrix <- as.matrix(loansMod)[sample(1:100),20:21]
heatmap(dataMatrix)
summary(loansMod)
plot(loansMod$Interest.Rate,loansMod$DebtToIncPrim,pch=19,col="blue")
lm1 <- lm(gloansMod$Interest.Rate ~ loansMod$DebtToIncPrim)
lm1 <- lm(loansMod$Interest.Rate ~ loansMod$DebtToIncPrim)
plot(loansMod$IntRatePrim,loansMod$DebtToIncPrim,pch=19,col="blue")
lm1 <- lm(loansMod$IntRatePrim ~ loansMod$DebtToIncPrim)
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
par(mfrow=c(1,2))
plot(loansMod$IntRatePrim,loansMod$DebtToIncPrim,pch=19,col="blue")
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
plot(loansMod$IntRatePrim,lm1$residuals,col="blue",pch=19)
abline(c(0,0),col="red",lwd=3)
hist(oansMod$IntRatePrim,col="blue",breaks=2)
hist(loansMod$IntRatePrim,col="blue",breaks=2)
hist(loansMod$IntRatePrim,col="blue")
hist(loansMod$IntRatePrim,col="blue",breaks=1)
hist(loansMod$IntRatePrim,col="blue",breaks=100)
hist(loansMod$IntRatePrim,col="blue",breaks=20)
hist(loansMod$IntRatePrim,col="blue")
hist(loansMod$IntRatePrim,col="blue",breaks=100)
hist(loansMod$IntRatePrim,col="blue",breaks=20)
meanChild <- mean(loansMod$IntRatePrim)
par(mfrow=c(1,1))
hist(loansMod$IntRatePrim,col="blue",breaks=20)
meanChild <- mean(loansMod$IntRatePrim)
lines(rep(meanChild,100),seq(0,150,length=100),col="red",lwd=5)
hist(loansMod$Interest.Rate,col="blue",breaks=20)
qplot(data=loansMod,x=Interest.Rate,main=Interest.Rate")
qplot(data=loansMod,x=Interest.Rate,main="Interest.Rate")
hist(loansMod$IntRatePrim,col="blue",breaks=20)
lines(rep(meanChild,20),seq(0,150,length=20),col="red",lwd=5)
lines(rep(meanChild),seq(0,150),col="red",lwd=5)
q()
remove(loansMod)
loansMod <- read.csv("./data/modLoansData.csv")
str(loansMod)
library("ggplot2", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("lattice", lib.loc="C:/Program Files/R/R-2.15.2/library")
xyplot(IntRatePrim ~ Employment.Length, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), xlab = "IntRatePrim", ylab = "Employment.Length")
xyplot(Revolving.CREDIT.Balance ~ IntRatePrim, data = loansMod, scales = list(log = TRUE), type = c("p", "g", "smooth"), ylab = "IntRatePrim", xlab =
"Revolving.CREDIT.Balance")
qqmath(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, groups = HomeOwner, f.value = ppoints(100), auto.key = TRUE, type = c("p", "g"), aspect = "xy")
densityplot(~ AvgIntFICO | factor(Loan.Purpose), data = loansMod, groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
densityplot(~ FICOBeg | factor(Loan.Purpose), data = loansMod, groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
densityplot(~ FICOBeg | factor(InquiresRank), data = loansMod, groups = HomeOwner, plot.points = FALSE, auto.key = TRUE)
densityplot(~ FICOBeg | factor(Loan.Purpose), data = loansMod, groups = InquiresRank, plot.points = FALSE, auto.key = TRUE)
densityplot(~ IntRatePrim | factor(FICOBeg), data = loansMod, groups = InquiresRank, plot.points = FALSE, auto.key = TRUE)
densityplot(~ FICOBeg | factor(IntRatePrim), data = loansMod, groups = InquiresRank, plot.points = FALSE, auto.key = TRUE)
plot(loansMod$IntRatePrim,loansMod$DebtToIncPrim,pch=19,col="blue")
lm1 <- lm(loansMod$IntRatePrim ~ loansMod$DebtToIncPrim)
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
plot(loansMod$IntRatePrim,FICOBeg,pch=19,col="blue")
plot(loansMod$IntRatePrim,loansMod$FICOBeg,pch=19,col="blue")
lm1 <- lm(loansMod$IntRatePrim ~ loansMod$FICOBeg)
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
par(mfrow=c(1,2))
plot(loansMod$IntRatePrim,loansMod$FICOBeg,pch=19,col="blue")
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
plot(loansMod$IntRatePrim,lm1$residuals,col="blue",pch=19)
abline(c(0,1),col="red",lwd=3)
plot(loansMod$IntRatePrim,loansMod$FICOBeg,pch=19,col="blue")
par(mfrow=c(1,1))
plot(loansMod$IntRatePrim,loansMod$FICOBeg,pch=19,col="blue")
lm1 <- lm(loansMod$FICOBeg ~ loansMod$IntRatePrim)
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
lm1
newLoans <- data.frame(loansMod$IntRatePrim=rep(NA,1e6),loansMod$FICOBeg=rep(NA,1e6))
newLoans <- data.frame(IntRatePrim=rep(NA,1e6),FICOBeg=rep(NA,1e6))
newLoans$IntRatePrim <- rnorm(1e6,mean=mean(loansMod$$IntRatePrim),sd=sd(loansMod$$IntRatePrim))
newLoans$IntRatePrim <- rnorm(1e6,mean=mean(loansMod$IntRatePrim),sd=sd(loansMod$IntRatePrim))
newLoans$IntRatePrim <- rnorm(1e6,mean=mean(loansMod$IntRatePrim),sd=sd(loansMod$IntRatePrim))
smoothScatter(newLoans$IntRatePrim,newLoans$FICOBeg)
abline(lm1,col="red",lwd=3)
library("KernSmooth", lib.loc="C:/Program Files/R/R-2.15.2/library")
smoothScatter(newLoans$IntRatePrim,newLoans$FICOBeg)
abline(lm1,col="red",lwd=3)
xyplot(newLoans$IntRatePrim,newLoans$FICOBeg)
library("PerformanceAnalytics", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("plyr", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
smoothScatter(newLoans$IntRatePrim,newLoans$FICOBeg)
x <- newLoans$IntRatePrim; y <- newLoans$FICOBeg
qqplot(x,y)
View(newLoans)
View(newLoans)
newLoans$FICOBeg <- lm1$coeff[1] + lm1$coeff[2]*newLoans$IntRatePrim + rnorm(1e6,sd=sd(lm1$residuals))
View(newLoans)
View(newLoans)
smoothScatter(newLoans$IntRatePrim,newLoans$FICOBeg)
abline(lm1,col="red",lwd=3)
set.seed(134325); sampleLoan1 <- newLoan[sample(1:1e6,size=50,replace=F),]
set.seed(134325); sampleLoan1 <- newLoans[sample(1:1e6,size=50,replace=F),]
sampleLm1 <- lm(sampleLoan1$IntRatePrim ~ sampleLoan1$FICOBeg)
plot(sampleLoan1$FICOBeg,sampleLoan1$IntRatePrim,pch=19,col="blue")
lines(sampleLoan1$FICOBeg,sampleLm1$fitted,lwd=3,lty=2)
abline(lm1,col="red",lwd=3)
plot(sampleLoan1$IntRatePrim,sampleLoan1$FICOBeg,pch=19,col="blue")
lines(sampleLoan1$FICOBeg,sampleLm1$fitted,lwd=3,lty=2)
lines(sampleLoan1$IntRatePrim,sampleLm1$fitted,lwd=3,lty=2)
abline(lm1,col="red",lwd=3)
set.seed(134325); sampleLoan1 <- newLoans[sample(1:1e6,size=50,replace=F),]
sampleLm1 <- lm(sampleLoan1$IntRatePrim ~ sampleLoan1$FICOBeg)
plot(sampleLoan1$IntRatePrim,sampleLoan1$FICOBeg,pch=19,col="blue")
lines(sampleLoan1$IntRatePrim,sampleLm1$fitted,lwd=3,lty=2)
abline(lm1,col="red",lwd=3)
lines(sampleLoan1$FICOBeg,sampleLm1$fitted,lwd=3,lty=2)
sampleLm <- vector(100,mode="list")
for(i in 1:100){
sampleLoan <- newLoans[sample(1:1e6,size=50,replace=F),]
sampleLm[[i]] <- lm(sampleLoan1$IntRatePrim ~ sampleLoan1$FICOBeg)
}
smoothScatter(sampleLoan1$FICOBeg,sampleLoan1$IntRatePrim)
for(i in 1:100){abline(sampleLm[[i]],lwd=3,lty=2)}
abline(lm1,col="red",lwd=3)
smoothScatter(sampleLoan1$IntRatePrim,sampleLoan1$FICOBeg)
for(i in 1:100){abline(sampleLm[[i]],lwd=3,lty=2)}
abline(lm1,col="red",lwd=3)
par(mfrow=c(1,2))
hist(sapply(sampleLm,function(x){coef(x)[1]}),col="blue",xlab="Intercept",main="")
hist(sapply(sampleLm,function(x){coef(x)[2]}),col="blue",xlab="Slope",main="")
sampleLoan4 <- newLoans[sample(1:1e6,size=50,replace=F),]
sampleLm4 <- lm(sampleLoan1$IntRatePrim ~ sampleLoan1$FICOBeg)
summary(sampleLm4)
hist(sapply(sampleLm,function(x){coef(x)[2]}),col="blue",xlab="Slope",main="",freq=F)
lines(seq(0,5,length=100),dnorm(seq(0,5,length=100),mean=coef(sampleLm4)[2],
sd=summary(sampleLm4)$coeff[2,2]),lwd=3,col="red")
hist(sapply(sampleLm,function(x){coef(x)[2]}),col="blue",xlab="Slope",main="",freq=F)
lines(seq(0,5,length=100),dnorm(seq(0,5,length=100),mean=coef(sampleLm4)[2],sd=summary(sampleLm4)$coeff[2,2]),lwd=3,col="red")
hist(sapply(sampleLm,function(x){coef(x)[2]}),col="blue",xlab="Slope",main="",freq=F)
lines(seq(0,5,length=100),dnorm(seq(0,5,length=100),mean=coef(sampleLm4)[2],sd=summary(sampleLm4)$coeff[2,2]),lwd=3,col="red")
summary(sampleLm4)$coeff
confint(sampleLm4,level=0.95)
lm1 <- lm(loansMod$FICOBeg ~ loansMod$IntRatePrim)
plot(loansMod$IntRatePrim,loansMod$FICOBeg,pch=19,col="blue")
lines(loansMod$IntRatePrim,lm1$fitted,col="red",lwd=3)
lm1$coeff
confint(lm1,level=0.95)
summary(lm1)$coeff
set.seed(134325); sampleLoan1 <- newLoans[sample(1:1e6,size=50,replace=F),]
sampleLm1 <- lm(sampleLoan1$IntRatePrim ~ sampleLoan1$FICOBeg)
str(loansMod)
plot(loansMod$Interest.Rate ~ jitter(as.numeric(loansMod$Loan.Purpose)),col="blue",xaxt="n",pch=19)
plot(loansMod$InquiresRank ~ jitter(as.numeric(loansMod$Loan.Purpose)),col="blue",xaxt="n",pch=19)
plot(loansMod$InquiresRank ~ jitter(as.numeric(loansMod$Loan.Purpose)),col="blue",xaxt="n",pch=19)
axis(side=1,at=unique(as.numeric(loansMod$Loan.Purpose)),labels=unique(loansMod$Loan.Purpose))
axis(side=1,at=unique(as.numeric(loansMod$Loan.Purpose)),labels=unique(loansMod$Loan.Purpose))
axis(side=1,at=unique((loansMod$Loan.Purpose)),labels=unique(loansMod$Loan.Purpose))
plot(loansMod$InquiresRank ~ jitter((loansMod$Loan.Purpose)),col="blue",xaxt="n",pch=19)
lm1 <- lm(loansMod$InquiresRank ~ as.factor(loansMod$Loan.Purpose))
lm1 <- lm(loansMod$InquiresRank ~ as.factor(loansMod$EmpYrsMod))
lm1 <- lm(loansMod$EmpYrsMod ~ as.factor(loansMod$InquiresRank))
summary(lm1)
plot(loansMod$EmpYrsMod ~ jitter(as.numeric(loansMod$InquiresRank)),col="blue",xaxt="n",pch=19)
axis(side=1,at=unique(as.numeric(loansMod$InquiresRank)),labels=unique(loansMod$InquiresRank))
points(1:4,lm1$coeff[1] + c(0,lm1$coeff[2:4]),col="red",pch="-",cex=5)
confint(lm1)
lm2 <- lm(loansMod$EmpYrsMod ~ relevel(loansMod$InquiresRank,ref="Z"))
summary(lm2)
confint(lm2)
anova(lm1)
lm1 <- aov(loansMod$EmpYrsMod ~ as.factor(loansMod$InquiresRank))
TukeyHSD(lm1)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$HomeOwner)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$HomeOwner=="1")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$HomeOwner)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$HomeOwner=="0")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="A")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="B")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="C")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
# Test InquiresRank Z
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="Z")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19)
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="Z")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3, main="InquiresRank Z")
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="InquiresRank Z")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="Z")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="InquiresRank C")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="C")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="InquiresRank B")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="B")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank )
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="InquiresRank A")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="A")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
# Test InquiresRank A different slopes
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank + loansMod$InquiresRank*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="InquiresRank A different slopes")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="A")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] +lmBoth$coeff[4])),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$InquiresRank + loansMod$InquiresRank*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="InquiresRank A different slopes")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$InquiresRank =="A")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] +lmBoth$coeff[4]),col="black",lwd=3)
summary(lmBoth)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$MoInc + loansMod$MoInc*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Interactions for continuous variables (like income)")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$MoInc > 1000)*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] +lmBoth$coeff[4]),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$MoInc + loansMod$MoInc*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Continuous variables income < 2000 ")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$MoInc < 2000)*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] +lmBoth$coeff[4]),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$MoInc + loansMod$MoInc*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Continuous variables income < 3000 ")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$MoInc < 3000)*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] +lmBoth$coeff[4]),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$MoInc + loansMod$MoInc*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Continuous variables income < 3000 ")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$MoInc < 3000)*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$MoInc + loansMod$MoInc*loansMod$FICOBeg)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Continuous variables income < 3000 ")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$MoInc < 3000)*1+1))
abline(c(lmBoth$coeff[1] + lmBoth$coeff[4],lmBoth$coeff[2]  + lmBoth$coeff[3]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3], lmBoth$coeff[2] + lmBoth$coeff[4]),col="black",lwd=3)
par(mfrow=c(1,2))
plot(loansMod$FICOBeg,loansMod$FICOBeg,col=as.numeric(loansMod$State),pch=19)
plot(1:10,type="n",xaxt="n",yaxt="n",xlab="",ylab="")
legend(1,10,col=unique(as.numeric((loansMod$State)),legend=unique((loansMod$State),pch=19)
par(mfrow=c(1,2))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,col=as.numeric(loansMod$State),pch=19)
plot(1:50,type="n",xaxt="n",yaxt="n",xlab="",ylab="")
legend(1,10,col=unique(as.numeric((loansMod$State)),legend=unique((loansMod$State),pch=19)
par(mfrow=c(1,2))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,col=as.numeric(loansMod$State),pch=19, main="By State")
plot(1:50,type="n",xaxt="n",yaxt="n",xlab="",ylab="")
legend(1,50,col=unique(as.numeric(loansMod$State),legend=unique((loansMod$State),pch=19)
par(mfrow=c(1,2))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,col=as.numeric(loansMod$State),pch=19, main="By State")
plot(1:50,type="n",xaxt="n",yaxt="n",xlab="",ylab="")
legend(1,50,col=unique(as.numeric(loansMod$State)),legend=unique(loansMod$State),pch=19)
par(mfrow=c(2,1))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,col=as.numeric(loansMod$State),pch=19, main="By State")
plot(1:50,type="n",xaxt="n",yaxt="n",xlab="",ylab="")
legend(1,50,col=unique(as.numeric(loansMod$State)),legend=unique(loansMod$State),pch=19)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=as.numeric(loansMod$State), main="By State")
lmState <- lm(loansMod$IntRatePrim ~ loansMod$FICOBeg + loansMod$State + loansMod$IntRatePrim*loansMod$State )
abline(c(lmState$coeff[1] + lmState$coeff[6],lmState$coeff[2]+ lmState$coeff[12]),col=5,lwd=3)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=as.numeric(loansMod$State))
lmState <- lm(loansMod$IntRatePrim ~ loansMod$FICOBeg + loansMod$State + loansMod$FICOBeg*loansMod$State )
abline(c(lmState$coeff[1] + lmState$coeff[6],lmState$coeff[2]+ lmState$coeff[12]),col=5,lwd=3)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=as.numeric(loansMod$State=="CO"), main = "By State")
lmState <- lm(loansMod$IntRatePrim ~ loansMod$FICOBeg + loansMod$State + loansMod$FICOBeg*loansMod$State )
abline(c(lmState$coeff[1] + lmState$coeff[4],lmState$coeff[2]+ lmState$coeff[3]),col="red",lwd=3)
abline(c(lmState$coeff[1] + lmState$coeff[3],lmState$coeff[2]+ lmState$coeff[4]),col="black",lwd=3)
# Test State = fill in the blank
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$State)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="By State")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$State =="CO")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
# Test State = fill in the blank
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$State)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="State = CO")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$State =="CO")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$State)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="State = CA")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$State =="CA")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$State)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="State = LA")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$State =="LA")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
lmBoth <- lm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + loansMod$State)
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="State = NY")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=((loansMod$State =="NY")*1+1))
abline(c(lmBoth$coeff[1],lmBoth$coeff[2]),col="red",lwd=3)
abline(c(lmBoth$coeff[1] + lmBoth$coeff[3],lmBoth$coeff[2] ),col="black",lwd=3)
anova(lm(loansMod$IntRatePrim ~ loansMod$State))
lm1 <- lm(loansMod$IntRatePrim ~ as.factor(loansMod$State))
anova(lm1)
lm1 <- aov(loansMod$IntRatePrim ~ as.factor(loansMod$State))
TukeyHSD(lm1)
lm1 <- lm(loansMod$IntRatePrim ~ as.factor(loansMod$State == "CO"))
anova(lm1)
lm1 <- aov(loansMod$IntRatePrim ~ as.factor(loansMod$State))
TukeyHSD(lm1)
lm1 <- lm(loansMod$IntRatePrim ~ as.factor(loansMod$State == "CO"))
anova(lm1)
lm1 <- aov(loansMod$IntRatePrim ~ as.factor(loansMod$State == "CO"))
TukeyHSD(lm1)
lm1 <- lm(loansMod$IntRatePrim ~ as.factor(loansMod$State == "CA"))
anova(lm1)
lm1 <- aov(loansMod$IntRatePrim ~ as.factor(loansMod$State == "CO"))
TukeyHSD(lm1)
lm1 <- aov(loansMod$IntRatePrim ~ as.factor(loansMod$State == "CA"))
TukeyHSD(lm1)
histogram(~ AvgIntFICO | factor(State), data = loansMod)
histogram(~ AvgIntFICO | factor(State == "CA"), data = loansMod)
histogram(~ AvgIntFICO | factor(State == "KS"), data = loansMod)
histogram(~ AvgIntFICO | factor(State == "KS"), data = loansMod, main = "State = KS")
histogram(~ AvgIntFICO | factor(State), data = loansMod, main = "State")
histogram(~ IntRatePrim | factor(State), data = loansMod, main = "State")
histogram(~ AvgIntFICO | factor(State == "CA"), data = loansMod, main = "State = CA")
histogram(~ IntRatePrim | factor(State == "CA"), data = loansMod, main = "State = CA")
histogram(~ IntRatePrim | factor(State == "CT"), data = loansMod, main = "State = CT")
histogram(~ IntRatePrim | factor(State == "IN"), data = loansMod, main = "State = IN")
histogram(~ AvgIntFICO | factor(State == "IN"), data = loansMod, main = "State = IN")
histogram(~ FICOBeg | factor(State == "IN"), data = loansMod, main = "State = IN")
histogram(~ FICOBeg | factor(State == "CT"), data = loansMod, main = "State = CT")
histogram(~ FICOBeg | factor(State == "CA"), data = loansMod, main = "State = CA")
histogram(~ FICOBeg | factor(State == "CO"), data = loansMod, main = "State = CO")
histogram(~ FICOBeg | factor(State == "KS"), data = loansMod, main = "State = KS")
str(loansMod)
par(mfrow=c(1,4))
smoothScatter(loansMod$FICOBeg,loansMod$MoInc)
hist(loansMod$MoInc,col="blue",breaks=100)
hist(log(loansMod$MoInc+1),col="blue",breaks=100)
smoothScatter(age,log(loansMod$MoInc+1))
par(mfrow=c(1,4))
smoothScatter(loansMod$FICOBeg,loansMod$MoInc)
hist(loansMod$MoInc,col="blue",breaks=100)
hist(log(loansMod$MoInc+1),col="blue",breaks=100)
smoothScatter(loansMod$FICOBeg,log(loansMod$MoInc+1))
rlmBoth <- rlm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + log(loansMod$MoInc+1))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Income with rlm")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=(log(loansMod$MoInc+1)*1+1))
abline(c(rlmBoth$coeff[1],rlmBoth$coeff[2]),col="red",lwd=3)
abline(c(rlmBoth$coeff[1] + rlmBoth$coeff[3],rlmBoth$coeff[2] ),col="black",lwd=3)
library("MASS", lib.loc="C:/Program Files/R/R-2.15.2/library")
rlmBoth <- rlm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + log(loansMod$MoInc+1))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Income with rlm")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=(log(loansMod$MoInc+1)*1+1))
abline(c(rlmBoth$coeff[1],rlmBoth$coeff[2]),col="red",lwd=3)
abline(c(rlmBoth$coeff[1] + rlmBoth$coeff[3],rlmBoth$coeff[2] ),col="black",lwd=3)
par(mfrow=c(1,2))
rlmBoth <- rlm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + log(loansMod$MoInc+1))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Income with rlm")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=(log(loansMod$MoInc+1)*1+1))
abline(c(rlmBoth$coeff[1],rlmBoth$coeff[2]),col="red",lwd=3)
abline(c(rlmBoth$coeff[1] + rlmBoth$coeff[3],rlmBoth$coeff[2] ),col="black",lwd=3)
par(mfrow=c(1,1))
rlmBoth <- rlm(loansMod$IntRatePrim  ~ loansMod$FICOBeg + log(loansMod$MoInc+1))
plot(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19, main="Income with rlm")
points(loansMod$FICOBeg,loansMod$IntRatePrim,pch=19,col=(log(loansMod$MoInc+1)*1+1))
abline(c(rlmBoth$coeff[1],rlmBoth$coeff[2]),col="red",lwd=3)
abline(c(rlmBoth$coeff[1] + rlmBoth$coeff[3],rlmBoth$coeff[2] ),col="black",lwd=3)
par(mfrow=c(1,1))
rlmBoth <- rlm(loansMod$IntRatePrim  ~ log(loansMod$MoInc+1))
plot(log(loansMod$MoInc+1),loansMod$IntRatePrim,pch=19, main="Income with rlm")
abline(c(rlmBoth$coeff[1],rlmBoth$coeff[2]),col="red",lwd=3)
par(mfrow=c(1,1))
rlmBoth <- rlm(loansMod$IntRatePrim  ~ log(loansMod$MoInc+1))
plot(loansMod$IntRatePrim,log(loansMod$MoInc+1),pch=19, main="Income with rlm")
abline(c(rlmBoth$coeff[1],rlmBoth$coeff[2]),col="red",lwd=3)
library("reshape", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("reshape2", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
savehistory("~/R/dataanalysis-master/dataanalysis-master/Projects/Assignment_1/Assignment_1/history.2.17.2013")
q()
library("devtools", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("evaluate", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("ggplot2", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("KernSmooth", lib.loc="C:/Program Files/R/R-2.15.2/library")
library("lattice", lib.loc="C:/Program Files/R/R-2.15.2/library")
library("MASS", lib.loc="C:/Program Files/R/R-2.15.2/library")
library("PerformanceAnalytics", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("plyr", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("reshape", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
library("reshape2", lib.loc="C:/Users/EBI-Dev/Documents/R/win-library/2.15")
View(loansMod)
remove(loadMod)
remove(loansMod)
loansMod <- read.csv("./data/loansMod.csv")
save(loansMod, file = "./data/loansDataModified.rda")
loansMod <- read.csv("./data/modLoansData.csv")
save(loansMod, file = "./data/loansDataModified.rda")
loansRaw[1:13,] # limit record review to top 13 rows
dim(loansRaw)
head(loansRaw)
names(loansRaw)
nrow(loansRaw)
quantile(loansRaw$Open.CREDIT.Lines)
summary(loansRaw)
class(loansRaw)
sapply(loansRaw[1, ], class)
unique(loansRaw$FICO.Range)
length(unique(loansRaw$FICO.Range))
table(loansRaw$FICO.Range)
table(loansRaw$FICO.Range,loansRaw$Interest.Rate)
any(loansRaw$Monthly.Income[1:10] 3195)
all(loansRaw$Monthly.Income[1:10] < 3195)
any(loansRaw$Monthly.Income[1:10] == 3195)
str(loansMod)
dim(loansMod)
head(loansMod)
names(loansMod)
nrow(loansMod)
quantile(loansMod$Open.CREDIT.Lines)
summary(loansMod)
class(loansMod)
sapply(loansMod[1, ], class)
unique(loansMod$FICO.Range)
length(unique(loansMod$FICO.Range))
table(loansMod$FICO.Range)
table(loansMod$FICO.Range,loansMod$Interest.Rate)
any(loansMod$Monthly.Income[1:10] == 3195)
all(loansMod$Monthly.Income[1:10] < 3195)
loansModSubset <- loansMod[loansMod$FICO.Range=="640-644" & loansMod$IntRatePrim < mean(loansMod$IntRatePrim),c("FICO 640-644","IntRatePrim < Mean")]
loansModSubset <- loansMod[loansMod$FICO.Range 0 & loansMod$IntRatePrim 0),c("FICO 640-644","IntRatePrim < Mean")]
loansModSubset <- loansMod[loansMod$FICO.Range & loansMod$IntRatePrim),c("FICO 640-644","IntRatePrim < Mean")]
loansModSubset <- loansMod[loansMod$FICO.Range & loansMod$IntRatePrim,c("FICO.Range","IntRatePrim")]
loansModSubset <- loansMod[loansMod$FICOBeg & loansMod$IntRatePrim,c("FICOBeg","IntRatePrim")]
summary(loansModSubset)
View(loansModSubset)
View(loansModSubset)
loansModSubset640 <- loansMod[loansMod$FICOBeg 640 & loansMod$IntRatePrim,c("FICOBeg","IntRatePrim")]
loansModSubset640 <- loansMod[loansMod$FICOBeg==640 & loansMod$IntRatePrim,c("FICOBeg","IntRatePrim")]
View(loansModSubset640)
loansModSubsetLowFICOLowInt <- loansMod[loansMod$FICOBeg < mean(loansMod$FICOBeg) & loansMod$IntRatePrim < mean(loansMod$IntRatePrim),c("FICOBeg","IntRatePrim")]
View(loansModSubsetLowFICOLowInt)
mean(loansMod$IntRatePrim
)
loansModSubsetHiFICOHiInt <- loansMod[loansMod$FICOBeg > mean(loansMod$FICOBeg) & loansMod$IntRatePrim > mean(loansMod$IntRatePrim),c("FICOBeg","IntRatePrim")]
View(loansModSubsetHiFICOHiInt)
View(loansModSubsetHiFICOHiInt)
mean(loansMod$FICOBeg)
remove(loansModSubset640)
q()
